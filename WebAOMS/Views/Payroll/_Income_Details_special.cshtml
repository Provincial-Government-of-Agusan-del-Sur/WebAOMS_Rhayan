@{
    Layout = null;
}


<div class="form-horizontal col-sm-12">
    <form id="frm_laonDetails">
        <input id="txt_t_Compensation_col_temp_id" hidden type="text" name="t_Base_deductionID" value="@ViewBag.t_Compensation_col_temp_id" />
        <input id="txt_eid" hidden type="text" name="eid" value="@ViewBag.eid" />
        
        <div class="row">
            <div class="col-lg-12 no-padding">
                <div class="col-lg-12">
                    <div class="box-head no-padding">
                        <h4>
                            Compensation Details Details
                        </h4>
                    </div>
                    <div>
                        <div class="form-group form-group-md">
                            <script>
                                function deduct_para() {
                                    return { compensationID: $("#ddp_compensation").data("kendoDropDownList").value(),col_id:@ViewBag.col_id,isEdit: @ViewBag.isEdit };
                                }
                            </script>
                            <div class="col-md-12">
                                @(Html.Kendo().DropDownList()
                                .Name("ddl_AmountType")
                                        .DataTextField("Col_description")
                                        .DataValueField("Col_id")
                                .HtmlAttributes(new { style = "width:100%", @readonly = "readonly" })
                                .OptionLabel("Select Amount type")
                                .Filter("contains")
                                .DataSource(source =>
                                {
                                    source.Read(read =>
                                    {
                                        read.Action("get_ref_Employee_Income_special", "Payroll").Data("deduct_para");
                                    })
                                    .ServerFiltering(false);
                                }))

                                <script>
                                    function changeDeduction(e) {
                                        var dataItem = this.dataItem(e.item.index());
                                        toastr('Message', 'Compensation Change')
                                    }
                                </script>
                            </div>
                        </div>
                       
                        <div class="form-group form-group-md">

                            <div class="col-md-3">
                                <label class="control-label control-width-small">Value</label>
                            </div>
                            <div class="col-md-9">
                                <input name="MonthlyAmount" id="txt_monthlyAmount" class="form-control text-right " placeholder="" value="@ViewBag.Amount" type="text">
                            </div>
                        </div>
                    </div>
                </div>
            <script>

        var dtypid;
        $(document).ready(function () {
            var istrue = true;
            var dropdownlist = $("#ddl_AmountType").data("kendoDropDownList")
            dropdownlist.value(@ViewBag.col_id)
            if ("@ViewBag.isEdit" == "1") {
                dropdownlist.readonly()
                $("#del_deduct").show()
            }
            else {
                $("#del_deduct").hide()
                dropdownlist.readonly(false)
            }
            $(function () {
                if (@ViewBag.col_type_id== 1 || @ViewBag.col_type_id== 3)
                {
                    $('#txt_monthlyAmount').number(true, 2);
                }
            });
        })


        function save_income_special() {
            var amount;
            var value_str;
            if (@ViewBag.col_type_id== 1 || @ViewBag.col_type_id== 3)
            {
                amount = $("#txt_monthlyAmount").val()
            }
            else{
                amount = 0
                value_str = $("#txt_monthlyAmount").val()
            }


            var url = '@Url.Action("save_income_special", "Payroll")';
            $.post(url, { t_Compensation_col_temp_id: @ViewBag.t_Compensation_col_temp_id, Amount: amount,value:value_str,col_id:@ViewBag.col_id,col_type_id:@ViewBag.col_type_id,eid:@ViewBag.eid,batchno:$("#txt_batchno").val()}, function (data) {
                $('#m_add_deductions_special').modal('hide');
                var gridData = $("#grid_employee_Income").data("kendoGrid");
                gridData.dataSource.read();
                var gridData_c = $("#grid_employee_compensation").data("kendoGrid");
                gridData_c.dataSource.read();
                get_netAmount();
        })
        .fail(function (jqXHR, textStatus, error) {
            stopSpin()
            toastr.warning(error, 'System Message');
        });
    }
                        </script>
                </div>
        </div>
    </form>
</div>

