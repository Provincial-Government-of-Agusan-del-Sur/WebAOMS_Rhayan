<div class="box col-md-12"> 
    <form id="frm_project_details">


        <div style="display:none">
            <div class="small_m-label" style="padding-left:5px">Fund ID</div>
            <div class="m-field" style="width:310px; ">
                <span id="sofid" onmouseover="spanhover('spanProjectname')" onmouseout="spanout('spanProjectname')" class="k-widget k-autocomplete k-header k-state-default k-sate-hover" style="width:40px;">
                    <input id="txtprojectID" name="projectID" class="k-input autoselect"  value="@ViewBag.projectid" style="width:100%;font-family:'Segoe UI' !important;text-align:center" />
                </span>
            </div>
            <div class="clear topm-5"></div>
            <div class="clear topm-5"></div>
            <div class="padding-5"></div>
        </div>
        <script>
            function paraSFund() {
                return { fundcode: 301 }
            }
            function paraFund() {
                return { datasourceid: 2 }
            }
        </script>
        <div class="row">
            <div class="form-group col-md-6">
                <label for="project-year">Project year</label>
                <input id="txtyearProject" class='form-control' name="project_year" value="@ViewBag.project_year" type='text' placeholder="Year" />
            </div>
            <div class="form-group col-md-6">
                <label for="project-year">Date of NADAI</label>
                @(Html.Kendo().DatePicker()
                    .Name("date_NADAI")
                    //.Value(ViewBag.date_NADAI)
                    .Format("MMMM dd, yyyy")
                    .HtmlAttributes(new { style = "width:100%", type = "text", @class = "input-group" })
                )
                
            </div>
        </div>
        
        <div class="form-group">
            <label for="source-of-fund">Source of fund</label>
            <div class="input-group">
                @(Html.Kendo().DropDownList()
                .Name("fundid")
                //.HtmlAttributes(new { style = "width: 100%" })

                .HtmlAttributes(new { Style="border:none!important", @class = "form-control" })
                .DataTextField("txt")
                .DataValueField("val")
                //.AutoBind(true)
                .Filter("contains")

              .DataSource(source =>
              {
                  source.Read(read =>
                  {
                      read.Action("LoadComboSourceOfFund", "PrivateShared").Data("paraSFund");
                  })
                  .ServerFiltering(true);
              }))

                <span class="input-group-btn dropup" style="padding-left:4px">
                    <button class="btn btn-equal" type="button" onclick="addreff_SourceOfFund()"><i class="fa fa-gears"></i></button>
                </span>
                </div>
            </div>

        <div class="form-group">
            <label for="source-of-fund">Type of Program/Project</label>
            @(Html.Kendo().DropDownList()
                .Name("programTypeId")
                .HtmlAttributes(new { style = "width: 100%" })
                .DataTextField("ProgramTypeName")
                .DataValueField("programTypeId")
                //.AutoBind(true)
                .Filter("contains")

              .DataSource(source =>
              {
                  source.Read(read =>
                  {
                      read.Action("dp_projectType", "Project");
                  })
                  .ServerFiltering(true);
              }))
        </div>

        <div class="form-group">
            <label for="project-name">Project Name</label>
            <textarea id="txtprojectName" name="project_name" class="form-control">@ViewBag.project_name</textarea>

        </div>
        <div class="form-group">
            <label for="location">Location</label>
            <textarea id="txtprojectLocation" name="location" class="form-control">@ViewBag.location</textarea>
        </div>


       <div class="row">
           <div class="form-group col-md-6">
               <label for="source-of-fund">Mechanism/Mode of Implementation</label>
               @(Html.Kendo().DropDownList()
                .Name("mechanismId")
                .HtmlAttributes(new { style = "width: 100%" })
                .DataTextField("mechanismName")
                .DataValueField("mechanismId")
                //.AutoBind(true)
                .Filter("contains")

              .DataSource(source =>
              {
                  source.Read(read =>
                  {
                      read.Action("dp_mechanism", "Project");
                  })
                  .ServerFiltering(true);
              }))
           </div>
           <div class="form-group col-md-6">
               <label for="source-of-fund">Estimated date of completion</label>
               @(Html.Kendo().DatePicker()
                    .Name("date_completion")
                    .Format("MMMM dd, yyyy")
                    .HtmlAttributes(new { style = "width:100%", type = "text", @class = "input-group" })
               )
           </div>
       </div>
       
    </form>
    </div>
    <script>
        var mg = new mgsInfo()
        $(document).ready(function () {
            $("#fundid").data("kendoDropDownList").value(@ViewBag.fundID)
        })

        function addreff_SourceOfFund() {
            startSpin()
            $.get('@Url.Action("Index", "SourceOfFund")', { id: 1 }, function (r) {
                stopSpin()
                $("#h_reff_SourceOfFund").html("Source of Fund");
                $("#body_reff_SourceOfFund").html(r)
                $("#mdl_reff_SourceOfFund").modal("show");
            });
        }

        function saveProject() {
            startSpin()
    
            var frm = $("#frm_project_details").serialize();
            $.post('@Url.Action("SaveProject","Project")',
                   frm
                   //int projectYear = 0, string projectName = "", string location = "", int fundID = 0, int projectID = 0)
          ,
                function (r) {
                    stopSpin()
                    
                    if (r.success) {
                        var grid = $("#grid_project").data("kendoGrid");
                        grid.dataSource.read({
                            remarks: ""
                        })

                        toastr.success(r.message, 'System Message')
                        $("#mdl_doc_form").modal("hide");
                    }
                    else {
                        toastr.warning(r.message, 'System Message')
                    }
                }
            )
        }

        function warn_delete_project() {
            // toastr.warning("Access denied..!", 'System Message');
            //$("#mdl_newstatus").removeClass("modal")
            $(".modal").addClass("zdex");
            mg.bsyesNoWithRemarks("Are you sure you want to delete this project <b>@ViewBag.project_name?</b>", "deleteProject()")
        }

        function deleteProject() {
            remarks = $("#txt_remarks").val()
            $.post('@Url.Action("DeleteProject","Project")',
               { projectID: $('#txtprojectID').val(), remarks: remarks },
                function (r) {
                    if (r == 6) {
                        zdex()
                        var grid = $("#grid_project").data("kendoGrid");
                        grid.dataSource.read({
                            remarks: ""
                        })
                        $('#modal_delete').modal('hide');
                        $("#mdl_doc_form").modal("hide");
                    }
                    else {
                       
                    }
                }
            )
        }

    </script>